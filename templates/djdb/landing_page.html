{% extends "common/base.html" %}

{% block breadcrumbs %}
<a href="/">chipradio home</a>
{% endblock %}

{% block content %}
Landing page for DJDB app

<h2>Recent Reviews</h2>
<ul>
{% for rev in recent_reviews %}
<li> <a href="{{ rev.subject.url }}">{{ rev.subject.title }},</a>
reviewed by {{ rev.author }}:  <i>{{ rev.title }}</i>
&nbsp;&nbsp;
<small>Posted {{ rev.timestamp_display|date:"F j, Y P" }}</small>
{% endfor %}
</ul>

<h2>Search the Database</h2>
<form action="" method="post">
<input type="text" name="query">
<input type="submit" value="Search">
</form>
</p>

{% if query_str %}
<p>Query was "{{ query_str }}".
{% if invalid_query %}<br><b>Invalid Query!</b>{% endif %}
</p>

<h3>Artists</h3>
<i>{{ query_results.Artist|length }}
matching artist{{ query_results.Artist|pluralize }}</i><br>
{% if query_results.Artist %}
<table>
{% for artist in query_results.Artist %}
<tr>
<td><a href="{{ artist.url}}">{{ artist.pretty_name }}</a></td>
<td>{{ artist.num_albums }} album{{ artist.num_albums|pluralize }}</td>
</tr>
{% endfor %}
</table>
{% endif %}

<h3>Albums</h3>
<i>{{ query_results.Album|length }}
matching album{{ query_results.Album|pluralize }}</i><br>
{% if query_results.Album %}
<table>
{% for album in query_results.Album %}
<tr>
<td><a href="{{ album.artist_url}}">{{ album.artist_name }}</a></td>
<td><a href="{{ album.url }}">{{ album.title }}</a></td>
<td>
{% if album.num_reviews %}
{{ album.num_reviews }} review{{ album.num_reviews|pluralize }}
{% endif %}
</td>
</tr>
{% endfor %}
</table>
{% endif %}

<h3>Tracks</h3>
<i>{{ query_results.Track|length }}
matching track{{ query_results.Track|pluralize }}</i>
{% if query_results.Track %}
<table>
{% for track in query_results.Track %}
<tr>
<td>{{ track.title }}</td>
<td><a href="{{ track.artist_url }}">{{ track.artist_name }}</a></td>
<td><a href="{{ track.album.url }}">{{ track.album.title }}</a></td>
{% endfor %}
</table>
{% endif %}

{% endif %}


{% endblock %}
